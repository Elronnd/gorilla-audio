replace more asserts with explicit failures (returned to caller)
